<!DOCTYPE html>
<html lang="ko">

<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1.0" />
    <title>ip 설정 페이지</title>

    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <link href="stylesheets/materialize.min.css" type="text/css" rel="stylesheet" media="screen,projection" />
    <link href="stylesheets/style.css" type="text/css" rel="stylesheet" media="screen,projection" />

    <style>
        .ipSetButton {
            width: 80px;
            margin: 0 5px 5px 5px;
            font-weight: bold;
        }
        .ipDot {
            margin: 0 5px 20px 5px;
            font-weight: bold;
        }
    </style>

</head>

<body onload="getMapData()">
    <header class="section no-pad-bot" id="index-banner">
        <br />
        <div class="container">
            <h1 class="header center">
                <a href="/">
                    <img src="images/pbangjari-logo.png" alt="logo" width="300px">
                </a>
            </h1>
        </div>
        <br />
    </header>

    <div class="container">
        <form method="post" enctype="application/json" action="api/pcBang/create/ServerTest">
            <div class="divider"></div>
            <div class="section">
                <div class="row text-darken-1" style="margin:0 1rem 0 0">
                    <div class="col s12 m2" style="margin-top:0">
                        <button class="ipSetButton" onclick="allCheck(0)" type="button" name="autoButton">자동설정</button>
                    </div>
                    <div class="col s12 m2" style="margin-top:0">
                        <button class="ipSetButton" onclick="allCheck(1)" type="button" name="autoButton">전체선택</button>
                    </div>
                    <div class="col s12 m2" style="margin-top:0">
                        <button class="ipSetButton" onclick="allCheck(2)" type="button" name="autoButton">전체해제</button>
                    </div>
                    <div class="col s12 m2" style="margin-top:0">
                        <button class="ipSetButton" type="button" onclick="allCheck(3)" name="autoButton">+1</button>
                    </div>
                    <div class="col s12 m2" style="margin-top:0">
                        <button class="ipSetButton" type="button" onclick="allCheck(4)" name="autoButton">-1</button>
                    </div>
                    <blockquote class="right" style="margin: 0 0 0 0">IP 상세설정</blockquote>
                </div>

            </div>

            <div class="section">
                <div class="row">
                    <!-- <div id="ipList" class="col s7 m5 push-l1"> -->
                    <div id="ipList" class="center">
                        <div class="valign-wrapper col s12 m6 l4" id="ipSet" style="display:none; margin-bottom: 0px;">
                            <span style="height:2rem; margin-top:10px;">
                                <input type="checkbox" class="filled-in" id="ipCheck" style="height:2rem; margin-top:0px;" />
                                <label for="ipCheck"></label>
                            </span>
                            <span id="ipNum" style="width:30px; height:2rem; margin-top:10px;"></span>
                            <input class="center" name="adminIPAddress[ipFirst]" style="width:30px; height:2rem; margin-bottom:2px;" id="ipFirst" type="text" class="validate" onkeydown="onKeyDown()" required>
                            <span class="ipDot" style="margin-bottom:2px;">.</span>
                            <input class="center" name="adminIPAddress[ipSecond]" style="width:30px; height:2rem; margin-bottom:2px;" id="ipSecond" type="text" class="validate" onkeydown="onKeyDown()" required>
                            <span class="ipDot" style="margin-bottom:2px;">.</span>
                            <input class="center" name="adminIPAddress[ipThird]" style="width:30px; height:2rem; margin-bottom:2px;" id="ipThird" type="text" class="validate" onkeydown="onKeyDown()" required>
                            <span class="ipDot" style="margin-bottom:2px;">.</span>
                            <input class="center" name="adminIPAddress[ipFourth]" style="width:30px; height:2rem; margin-bottom:2px;" id="ipFourth" type="text" onkeydown="onKeyDown()" class="validate" required>
                            <br/>
                        </div>

                    </div>
                </div>
            </div>

            <div class="row center" style="margin-bottom:50px">
                <button class="btn-large waves-effect waves-light pulse" type="submit" name="action">등록완료
                    <i class="material-icons right">send</i>
                </button>
            </div>
        </form>
    </div>
    <script>
        // var pcMaps = <%-JSON.stringify("")%> 데이터베이스정보를 불러온다.
        var testLength = 100; // 선택한 pc좌석이 10일 경우
        var testIpFirst = 192;
        var testIpSecond = 168;
        var testIpThird = 46;
        // 테스트 IP
        var ipList = document.getElementById('ipList');
        var ipSet = document.getElementById('ipSet');
        function getMapData(){
            for (var i = 0; i < testLength; i++) {
                var addDiv = ipSet.cloneNode(true);
                addDiv.setAttribute('style','margin-bottom: 0px;');
                addDiv.children[0].children[0].setAttribute('id', 'ipCheck'+i);
                addDiv.children[0].children[1].setAttribute('for', 'ipCheck'+i);
                addDiv.children[1].innerHTML = (i+1)+'.&nbsp;&nbsp;';
                addDiv.children[2].setAttribute('value', ' ');
                addDiv.children[4].setAttribute('value', ' ');
                addDiv.children[6].setAttribute('value', ' ');
                addDiv.children[8].setAttribute('value', ' ');
                ipList.appendChild(addDiv);
            }
            ipList.removeChild(ipList.children[0]);
        }
        function onKeyDown() { // 숫자, 백스페이스, 탭키만 입력받게함
            if (event.keyCode < 48 || (event.keyCode > 57 && event.keyCode < 96) || event.keyCode > 105) {
                if (event.keyCode == 8 || event.keyCode == 9) {} else {
                    event.preventDefault(); // 입력안되게 함
                }
            }
        }

        function allCheck(check) {
            for (var i = 0; i < testLength; i++) {
                let checkState = ipList.children[i].children[0].children[0];
                let checkNum = ipList.children[i].children[8];
                if (check==0) { // 자동설정
                    if (checkState.checked) {
                        ipList.children[i].children[2].value = testIpFirst;
                        ipList.children[i].children[4].value = testIpSecond;
                        ipList.children[i].children[6].value = testIpThird;
                        ipList.children[i].children[8].value = i+1;
                    }
                }
                else if (check==1) { // 전체선택
                    checkState.checked = true;
                }
                else if(check==2){ // 전체해제
                    checkState.checked = false;
                }
                else if(check==3){ // ip 뒷자리 +1
                    if (checkState.checked) {
                        if (Number(checkNum.value)==255) {
                            continue;
                        }
                        checkNum.value = Number(checkNum.value)+1;
                    }
                }
                else if(check==4){ // ip 뒷자리 -1
                    if (checkState.checked) {
                        if (Number(checkNum.value)==0) {
                            continue;
                        }
                        checkNum.value = Number(checkNum.value)-1;
                    }
                }
            }
        }
    </script>
</body>

</html>
